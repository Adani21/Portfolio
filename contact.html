<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="stylesheet" href="./css/contact.css">
</head>

<body>
    <div class="loadingScreen">
        <h1 class="loadText">adani<span class="loadExtra">.dev</span></h1>
        <div class="loadDots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
        <p class="loadExp">Loading experience...</p>
    </div>
    <div class="gradient-bg">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
        <div class="gradient-orb orb-4"></div>
        <div class="gradient-orb orb-5"></div>
        <div class="gradient-orb orb-6"></div>
    </div>

    <div class="floating-shapes">
        <div class="shape shape-circle"></div>
        <div class="shape shape-square"></div>
        <div class="shape shape-circle"></div>
        <div class="shape shape-square"></div>
        <div class="shape shape-circle"></div>
        <div class="shape shape-square"></div>
        <div class="shape shape-circle"></div>
        <div class="shape shape-square"></div>
        <div class="shape shape-circle"></div>
        <div class="shape shape-square"></div>
        <div class="shape shape-circle"></div>
        <div class="shape shape-square"></div>
    </div>
    <section class="contact-section1 cf-section" id="contact">
        <div class="contact-card1 cf-card">
            <div class="cf-orbs">
                <span class="cf-orb cf-orb-1"></span>
                <span class="cf-orb cf-orb-2"></span>
                <span class="cf-orb cf-orb-3"></span>
            </div>

            <h2 class="cf-title">Let’s work together</h2>

            <form class="cf-form" novalidate>
                <div class="cf-field">
                    <input id="cf-name" name="name" type="text" placeholder="" required />
                    <label for="cf-name">Your name</label>
                </div>

                <div class="cf-field">
                    <input id="cf-email" name="email" type="email" placeholder="" required />
                    <label for="cf-email">Email address</label>
                </div>

                <div class="cf-field">
                    <input id="cf-subject" name="subject" type="text" placeholder="" />
                    <label for="cf-subject">Subject</label>
                </div>

                <div class="cf-field cf-textarea">
                    <textarea id="cf-message" name="message" rows="5" required></textarea>
                    <label for="cf-message">Your message</label>
                </div>

                <button class="cf-cta" type="submit">
                    <span>Send message</span>
                    <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill="currentColor" d="M4 12h13.17l-4.58-4.59L14 6l8 8-8 8-1.41-1.41L17.17 14H4z" />
                    </svg>
                </button>
                <p id="cf-status" class="cf-status" role="status" aria-live="polite"></p>
            </form>
        </div>
    </section>
    <script>
        (() => {
            const form = document.querySelector('.cf-form');
            if (!form) return;

            const nameEl = document.getElementById('cf-name');
            const emailEl = document.getElementById('cf-email');
            const subjectEl = document.getElementById('cf-subject');
            const messageEl = document.getElementById('cf-message');
            const statusEl = document.getElementById('cf-status');
            const btn = form.querySelector('.cf-cta');

            const emailRe = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i;
            const hasTwoWords = v => v.trim().split(/\s+/).length >= 2;
            const setErr = (el, on) => el?.closest('.cf-field')?.classList.toggle('is-error', on);

            form.addEventListener('submit', async (e) => {
                e.preventDefault(); // stopt refresh

                // validatie
                let bad = false;
                if (!hasTwoWords(nameEl.value)) { setErr(nameEl, true); bad = true; } else setErr(nameEl, false);
                if (!emailRe.test(emailEl.value.trim())) { setErr(emailEl, true); bad = true; } else setErr(emailEl, false);
                if (!subjectEl.value.trim()) { setErr(subjectEl, true); bad = true; } else setErr(subjectEl, false);
                if (!messageEl.value.trim()) { setErr(messageEl, true); bad = true; } else setErr(messageEl, false);

                if (bad) {
                    if (statusEl) { statusEl.textContent = '❌ Vul naam (2 woorden), geldig e‑mail, subject en bericht in.'; statusEl.style.color = '#e06b6b'; }
                    return;
                }

                // UI state
                const original = btn ? btn.innerHTML : null;
                if (btn) { btn.disabled = true; btn.setAttribute('aria-busy', 'true'); btn.innerHTML = 'Sending…'; }

                try {
                    const res = await fetch('/send', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            name: nameEl.value.trim(),
                            email: emailEl.value.trim(),
                            subject: subjectEl.value.trim(),
                            message: messageEl.value.trim()
                        })
                    });

                    if (res.status === 200 || res.status === 202) {
                        if (statusEl) { statusEl.textContent = '✅ Message sent!'; statusEl.style.color = 'lightgreen'; setTimeout(() => statusEl.textContent = '', 3000); }
                        form.reset();
                    } else {
                        if (statusEl) { statusEl.textContent = '❌ Server error while sending.'; statusEl.style.color = '#e06b6b'; }
                    }
                } catch (err) {
                    console.error(err);
                    if (statusEl) { statusEl.textContent = '⚠️ Cannot connect to server.'; statusEl.style.color = '#e06b6b'; }
                } finally {
                    if (btn) { btn.disabled = false; btn.removeAttribute('aria-busy'); btn.innerHTML = original; }
                }
            });
        })();
    </script>
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="/script.js" defer></script>
</body>

</html>